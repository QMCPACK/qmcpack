
\chapter{Contributing to the manual}
\label{chap:contrib}

This section briefly describes how to contribute to the manual and is primarily ``by developers, for developers.''   This section should iterate until a consistent view on style/contents is reached.

\textbf{\underline{Desirable:}}
\begin{itemize}
\item{Use the following table templates when describing XML input.}
\item{Instead of \ilatex{\\texttt} or \ilatex{\\verb} use
    \begin{itemize}
      \item{\ilatex{\\ishell} for shell text}
      \item{\ilatex{\\ixml} for xml text}
      \item{\ilatex{\\icode} for C++ text}
      \end{itemize}
     \bf{Except} within tabularx or math environments}
    \item{Instead of \ilatex{\\begin\{verbatim\}} environments, use the appropriate \ilatex{\\begin\{lstlisting\}[style=<see qmcpack_listings.sty>]}}.
\item{\ilatex{\\begin\{shade\}} can be used in place of \ilatex{\\begin\{lstlisting\}[style=SHELL]}}.
\item{Unicode rules}
\begin{itemize}
\item Do not use characters for which well-established latex idiom exists, especially dashes, quotes, and apostrophes.
\item Use math mode markup instead of unicode characters for equations.
\item Be cautious of WYSIWYG word processors; cutting and pasting can pickup characters promoted to unicode by the program.
\item Take a look at your text multibyte expanded; that is open it in (emacs and `esc-x toggle-enable-multibyte-characters')---see any unicode you did not intend?
\end{itemize}
\item{Place unformatted text targeted at developers working on the LaTeX in comments.  Include generously.}
\item{Encapsulate formatted text aimed at developers (like this entire chapter), in \ilatex{\\dev\{\}}.  Text encapsulated in this way will be removed from the user version of the manual by editing the definition of \ilatex{\\dev\{\}} in \ishell{qmcpack_manual.tex}.  Existing but deprecated or partially functioning features fall in this category.}
\item Newly added entries to a Bib file should be as complete as possible. Use a tool such as JabRef or Zotero that can automate creation of these entries from just a DOI.
\end{itemize}

\textbf{\underline{Forbidden:}}
\begin{itemize}
\item Including images instead of using lstlisting sections for text.
\item Using packages the LaTeX community considers \href{https://latex.org/forum/viewtopic.php?f=37&t=6637}{deprecated}.
\item Using packages, features, or fonts not included in texlive 2017 unless you ensure they degrade reasonably for 2017.
\item Adding packages unless they bring great value and are supported by tex4ht (unless you are willing to add the support).
\item Saving Tex files and Bib files in encodings other than UTF8. Some may report being ASCII encoded since they contain no unicode characters.
\end{itemize}


\textbf{\underline{Missing sections (these are opinions, not decided priorities):}}
\begin{itemize}
  \item{Description of XML input in general.  Discuss XML format, use of attributes and \texttt{<parameter/>}'s in general, case sensitivity (input is generally case sensitive), and behavior of \qmcpack when unrecognized XML elements are encountered (they are generally ignored without notification).}
  \item{Overview of the input file in general, broad structure, and at least one full example that works in isolation.}
\end{itemize}


\textbf{\underline{Information currently missing for a complete reference specification:}}
\begin{itemize}
  \item{Noting how many instances of each child element are allowed.  Examples: \texttt{simulation}--1 only, \texttt{method}--1 or more, \texttt{jastrow}--0 or more}.
\end{itemize}


Table templates follow for describing XML elements in reference fashion.  A number of examples can be found in, for example, Chapter~\ref{chap:hamiltobs}.  Preliminary style is (please weigh in with opinions): typewriter text (\ilatex{\\texttt\{\}}) for XML elements, attributes, and parameter names; normal text for literal information in the datatype, values, and default columns; bold (\ilatex{\\textbf\{\}}) text if an attribute or parameter must take on a particular value (values column); italics (\ilatex{\\textit\{\}}) for descriptive (nonliteral) information in the values column (e.g., \textit{anything}, \textit{non-zero}); and required/optional attributes or parameters noted by \texttt{some\_attr$^r$}/\texttt{some\_attr$^o$} superscripts.  Valid datatypes are text, integer, real, Boolean, and arrays of each.  Fixed length arrays can be noted, for example, by ``real array(3).''


Template for a generic XML element:
\FloatBarrier
\begin{table}[h]
\begin{center}
\begin{tabularx}{\textwidth}{l l l l l X }
\hline
\multicolumn{6}{l}{\texttt{generic} element} \\
\hline
\multicolumn{2}{l}{parent elements:} & \multicolumn{4}{l}{\texttt{parent1 parent2}}\\
\multicolumn{2}{l}{child  elements:} & \multicolumn{4}{l}{\texttt{child1 child2 child3 ...}}\\
\multicolumn{2}{l}{attributes}  & \multicolumn{4}{l}{}\\
   &   \bfseries name     & \bfseries datatype & \bfseries values & \bfseries default   & \bfseries description \\
   &   \texttt{attr1}$^r$ &  text              &                  &                     &                       \\
   &   \texttt{attr2}$^r$ &  integer           &                  &                     &                       \\
   &   \texttt{attr3}$^o$ &  real              &                  &                     &                       \\
   &   \texttt{attr4}$^o$ &  boolean           &                  &                     &                       \\
   &   \texttt{attr5}$^o$ &  text array        &                  &                     &                       \\
   &   \texttt{attr6}$^o$ &  integer array     &                  &                     &                       \\
   &   \texttt{attr7}$^o$ &  real array        &                  &                     &                       \\
   &   \texttt{attr8}$^o$ &  boolean array     &                  &                     &                       \\
\multicolumn{2}{l}{parameters}  & \multicolumn{4}{l}{}\\
   &   \bfseries name     & \bfseries datatype & \bfseries values & \bfseries default   & \bfseries description \\
   &   \texttt{param1}$^r$&  text              &                  &                     &                       \\
   &   \texttt{param2}$^r$&  integer           &                  &                     &                       \\
   &   \texttt{param3}$^o$&  real              &                  &                     &                       \\
   &   \texttt{param4}$^o$&  boolean           &                  &                     &                       \\
   &   \texttt{param5}$^o$&  text array        &                  &                     &                       \\
   &   \texttt{param6}$^o$&  integer array     &                  &                     &                       \\
   &   \texttt{param7}$^o$&  real array        &                  &                     &                       \\
   &   \texttt{param8}$^o$&  boolean array     &                  &                     &                       \\
\multicolumn{2}{l}{body text}  & \multicolumn{4}{l}{}\\
   &                           & \multicolumn{4}{l}{Long form description of body text format}                   \\
  \hline
\end{tabularx}
\end{center}
\end{table}
\FloatBarrier



``Factory'' elements are XML elements that share a tag but whose contents change based on the value an attribute, or sometimes multiple attributes, take.  The attribute(s) that determines the allowed content is subsequently referred to as the ``type selector''  (e.g., for \ixml{<estimator/>} elements, the type selector is usually the \ixml{type} attribute).  These types of elements are frequently encountered as they correspond (sometimes loosely, sometimes literally) to polymorphic classes in \qmcpack that are built in ``factories.''  This name is true to the underlying code but may be obscure to the general user (is there a better name to retain the general meaning?).   

The following template should be provided each time a new ``factory'' type is encountered (such as \ixml{<estimator/>}).  The table lists all types of possible elements (see ``type options'' in the template) and any attributes that are common to all possible related elements.  Specific ``derived'' elements are then described one at a time with the previous template, noting the type selector in addition to the XML tag (e.g., ``\ixml{estimator type=density} element'').

Template for shared information about ``factory'' elements.
\FloatBarrier
\begin{table}[h]
\begin{center}
\begin{tabularx}{\textwidth}{l l l l l X }
\hline
\multicolumn{6}{l}{\texttt{generic} factory element} \\
\hline
\multicolumn{2}{l}{parent elements:} & \multicolumn{4}{l}{\texttt{parent1 parent2}}\\
\multicolumn{2}{l}{child  elements:} & \multicolumn{4}{l}{\texttt{child1 child2 child3 ...}}\\
\multicolumn{2}{l}{type   selector:} & \multicolumn{4}{l}{\texttt{some} attribute}\\
\multicolumn{2}{l}{type   options :} & \multicolumn{4}{l}{Selection1}\\
\multicolumn{2}{l}{                } & \multicolumn{4}{l}{Selection2}\\
\multicolumn{2}{l}{                } & \multicolumn{4}{l}{Selection3}\\
\multicolumn{2}{l}{                } & \multicolumn{4}{l}{...}\\
\multicolumn{2}{l}{shared attributes:} & \multicolumn{4}{l}{}\\
   &   \bfseries name     & \bfseries datatype & \bfseries values & \bfseries default   & \bfseries description \\
   &   \texttt{attr1}     &  text              &                  &                     &                       \\
   &   \texttt{attr2}     &  integer           &                  &                     &                       \\
   &   ...                &                    &                  &                     &                       \\
  \hline
\end{tabularx}
\end{center}
\end{table}
\FloatBarrier
