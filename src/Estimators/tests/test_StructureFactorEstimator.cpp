//////////////////////////////////////////////////////////////////////////////////////
// This file is distributed under the University of Illinois/NCSA Open Source License.
// See LICENSE file in top directory for details.
//
// Copyright (c) 2024 QMCPACK developers.
//
// File developed by: Peter Doak, doakpw@ornl.gov, Oak Ridge National Lab
//
// File created by: Peter Doak, doakpw@ornl.gov, Oak Ridge National Lab
//////////////////////////////////////////////////////////////////////////////////////

#include "catch.hpp"

#include "StructureFactorEstimator.h"
#include "ValidStructureFactorInput.h"
#include "Particle/tests/MinimalParticlePool.h"
#include "QMCWaveFunctions/tests/MinimalWaveFunctionPool.h"
#include "RandomForTest.h"
#include "GenerateRandomParticleSets.h"
#include "Utilities/ProjectData.h"
#include "Utilities/for_testing/NativeInitializerPrint.hpp"
#include <iostream>

namespace qmcplusplus
{

constexpr bool generate_test_data = false;
  
namespace testing
{
class StructureFactorAccess
{
  using Real = StructureFactorEstimator::Real;

public:
  const Vector<Real>& getSKElecElec(const StructureFactorEstimator& sfe) const { return sfe.getSKElecElec(); }
  const Vector<std::complex<Real>>& getRhoKElec(const StructureFactorEstimator& sfe) const { return sfe.getRhoKElec(); }
};
} // namespace testing

class StructureFactorTests
{    
  using Data        = Vector<typename StructureFactorEstimator::Real>;
  using DataC        = Vector<std::complex<typename StructureFactorEstimator::Real>>;
  Data getSKElecElec();
  DataC getRhoKElec();
};
   
TEST_CASE("StructureFactorEstimator::StructureFactorEstimator", "[estimators]")
{
  using Input = qmcplusplus::testing::ValidStructureFactorInput;
  Communicate* comm;
  comm = OHMMS::Controller;

  ParticleSetPool particle_pool{MinimalParticlePool::make_diamondC_1x1x1(comm)};

  ParticleSet pset_elec{*(particle_pool.getParticleSet("e"))};
  ParticleSet pset_ions{*(particle_pool.getParticleSet("ion"))};

  pset_elec.R =
      ParticleSet::ParticlePos{{1.451870349, 1.381521229, 1.165202269}, {1.244515371, 1.382273176, 1.21105285},
                               {0.000459944, 1.329603408, 1.265030556}, {0.748660329, 1.63420622, 1.393637791},
                               {0.033228526, 1.391869137, 0.654413566}, {1.114198787, 1.654334594, 0.231075822},
                               {1.657151589, 0.883870516, 1.201243939}, {0.97317591, 1.245644974, 0.284564732}};

  Libxml2Document doc;
  bool okay       = doc.parseFromString(Input::xml[Input::valid::SKALL]);
  xmlNodePtr node = doc.getRoot();
  UPtr<StructureFactorInput> sf_in;
  sf_in = std::make_unique<StructureFactorInput>(node);
  StructureFactorEstimator sfe(*sf_in, pset_ions, pset_elec);
}

TEST_CASE("StructureFactorEstimator::Accumulate", "[estimators]")
{
  using Input = qmcplusplus::testing::ValidStructureFactorInput;
  Communicate* comm;
  comm = OHMMS::Controller;

  Libxml2Document doc;
  bool okay       = doc.parseFromString(Input::xml[Input::valid::SKALL]);
  xmlNodePtr node = doc.getRoot();
  UPtr<StructureFactorInput> sf_in;
  sf_in = std::make_unique<StructureFactorInput>(node);

  ParticleSetPool particle_pool{MinimalParticlePool::make_diamondC_1x1x1(comm)};

  ParticleSet pset_elec{*(particle_pool.getParticleSet("e"))};
  ParticleSet pset_ions{*(particle_pool.getParticleSet("ion"))};

  StructureFactorEstimator sfe(*sf_in, pset_ions, pset_elec);

  std::vector<OperatorEstBase::MCPWalker> walkers;
  int nwalkers = 3;
  for (int iw = 0; iw < nwalkers; ++iw)
    walkers.emplace_back(8);

  std::vector<ParticleSet::ParticlePos> deterministic_rs = {
      {
          {0.5156778693, 0.9486072659, -1.174232483},
          {-0.3166678548, 1.376550555, 1.445290089},
          {1.960713625, 2.472656727, 1.051449418},
          {0.7458532453, 0.5551358461, 4.080774784},
          {-0.3515016139, -0.5192222595, 0.9941511154},
          {-0.8354426622, 0.7071638107, -0.3409843445},
          {0.4386044741, 1.237378716, 2.331874132},
          {2.125850677, 0.322106719, 0.5825730562},
      },
      {
          {-0.4633736908, 0.06318772584, -0.8580153584},
          {-1.1749264, -0.6276503801, 0.07458759099},
          {1.327618122, 2.085829258, 1.415749788},
          {0.9114726782, 0.1789183617, -0.08135545254},
          {-2.267908812, 0.8029287457, 0.9522812963},
          {1.50271523, -1.844935298, 0.2805620432},
          {3.168934584, 0.1348338127, 1.371092796},
          {0.8310229182, 1.070827127, 1.180167317},
      },
      {
          {-0.04847732186, -1.201739907, -1.700527787},
          {0.1589259505, -0.3096047044, -2.06662631},
          {2.2559762, 1.62913239, -0.8024448156},
          {2.5347929, 3.121092796, 1.609780669},
          {-0.2892376184, -0.1520225108, -2.727613688},
          {0.2477154732, 0.5039232969, 2.995702744},
          {3.679345131, 3.037770271, 2.808899403},
          {0.6418578625, 1.935944557, 1.515637875},
      },
  };
  std::vector<ParticleSet> psets =
      testing::generateRandomParticleSets(pset_elec, pset_ions, deterministic_rs, nwalkers, generate_test_data);

  auto ref_walkers = makeRefVector<OperatorEstBase::MCPWalker>(walkers);
  auto ref_psets   = makeRefVector<ParticleSet>(psets);

  ProjectData test_project("test", ProjectData::DriverVersion::BATCH);

  auto wavefunction_pool =
      MinimalWaveFunctionPool::make_diamondC_1x1x1(test_project.getRuntimeOptions(), comm, particle_pool);
  auto& spomap      = wavefunction_pool.getWaveFunction("wavefunction")->getSPOMap();

  auto& trial_wavefunction = *(wavefunction_pool.getPrimary());
  std::vector<UPtr<TrialWaveFunction>> twfcs(nwalkers);
  for (int iw = 0; iw < nwalkers; ++iw)
    twfcs[iw] = trial_wavefunction.makeClone(psets[iw]);

  // These are just empty arguments to hang the accumulation test, StructureFactorEstimator never accesses into them.
  // In the application the estimator manager calls accumulate and all these vectors are really populated.
  std::vector<QMCHamiltonian> hams;
  auto ref_wfns = convertUPtrToRefVector(twfcs);
  auto ref_hams = makeRefVector<QMCHamiltonian>(hams);

  FakeRandom<OHMMS_PRECISION_FULL> rng;

  auto updateWalker = [](auto& walker, auto& pset_target, auto& trial_wavefunction) {
    pset_target.update(true);
    pset_target.donePbyP();
    trial_wavefunction.evaluateLog(pset_target);
    //pset_target.saveWalker(walker);
  };

  for (int iw = 0; iw < nwalkers; ++iw)
    updateWalker(walkers[iw], psets[iw], *(twfcs[iw]));

  using QMCT = OperatorEstBase::QMCT;
  std::vector<QMCT::RealType> rng_reals(nwalkers * QMCT::DIM * 2);
  testing::RandomForTest<QMCT::RealType> rft;
  rft.fillVecRng(rng_reals);
  auto it_rng_reals = rng_reals.begin();
  for (ParticleSet& pset : psets)
  {
    pset.R[0] = ParticleSet::PosType(*it_rng_reals++, *it_rng_reals++, *it_rng_reals++);
    pset.R[1] = ParticleSet::PosType(*it_rng_reals++, *it_rng_reals++, *it_rng_reals++);
  }
  for (int iw = 0; iw < nwalkers; ++iw)
    updateWalker(walkers[iw], psets[iw], *(twfcs[iw]));
  
  sfe.accumulate(ref_walkers, ref_psets, ref_wfns, ref_hams, rng);

  testing::StructureFactorAccess sfa;
  auto& sfk_e_e = sfa.getSKElecElec(sfe);
  auto& rhok_e  = sfa.getRhoKElec(sfe);

  if constexpr (true) //generate_test_data)
  {
    std::cout << "sfk_e_e_exected = ";
    std::cout << NativePrint(sfk_e_e) << '\n';
    std::cout << "rhok_e_expected = ";
    std::cout << NativePrint(rhok_e) << '\n';
    FAIL_CHECK("Test always fails when generating new test reference data.");
  }
}

template<typename T>
typename StructureFactorTests<T>::Data StructureFactorTests<T>::getSfkEEData()
{
  Data sfk_e_e_exected = { 19.73623085, 19.85599327, 13.72912788, 18.75673866, 18.75673866, 13.72912788, 19.85599327, 19.73623085, 32.80349731, 43.77883148, 33.19361115, 33.19361115, 43.77883148, 32.80349731, 11.48587227, 46.64709091, 13.93536186, 21.81977654, 16.97146797, 49.0378952, 49.0378952, 16.97146797, 21.81977654, 13.93536186, 46.64709091, 11.48587227, 15.27185249, 15.26608276, 27.79554367, 34.7771225, 50.21757126, 48.46035004, 13.67208576, 15.27589607, 24.97359276, 51.96620178, 10.82582951, 13.76047134, 13.76047134, 10.82582951, 51.96620178, 24.97359276, 15.27589607, 13.67208576, 48.46035004, 50.21757126, 34.7771225, 27.79554367, 15.26608276, 15.27185249, 16.81092834, 29.33479309, 5.10248518, 85.84146118, 85.84146118, 5.10248518, 29.33479309, 16.81092834, 25.95727539, 34.5015831, 21.52643585, 21.52643585, 34.5015831, 25.95727539, 35.05796432, 38.54359055, 38.54359055, 35.05796432, 19.39619255, 36.68960571, 16.29642677, 41.76596069, 39.29201508, 40.27943802, 43.67494965, 17.53614426, 17.01120758, 14.28325844, 14.28325844, 17.01120758, 17.53614426, 43.67494965, 40.27943802, 39.29201508, 41.76596069, 16.29642677, 36.68960571, 19.39619255, 8.223339081, 16.57196808, 16.75862885, 39.18902969, 28.35930443, 14.97254658, 11.20259285, 12.45506668, 23.81349754, 35.41851044, 6.74987793, 6.768158913, 6.768158913, 6.74987793, 35.41851044, 23.81349754, 12.45506668, 11.20259285, 14.97254658, 28.35930443, 39.18902969, 16.75862885, 16.57196808, 8.223339081, 28.73698616, 28.73698616, 23.82761765, 13.70425797, 37.05511093, 20.61174965, 29.07460403, 13.55575943, 28.73127365, 50.90294647, 12.75067329, 37.09168243, 21.69445038, 21.69445038, 37.09168243, 12.75067329, 50.90294647, 28.73127365, 13.55575943, 29.07460403, 20.61174965, 37.05511093, 13.70425797, 23.82761765, 20.25505257, 20.82879829, 22.74308205, 11.197855, 11.80153656, 12.47373486, 41.87596893, 15.71939564, 18.91372871, 12.80999374, 47.60126877, 23.973526, 23.973526, 47.60126877, 12.80999374, 18.91372871, 15.71939564, 41.87596893, 12.47373486, 11.80153656, 11.197855, 22.74308205, 20.82879829, 20.25505257, 13.79166222, 18.27315712, 32.10044861, 19.95432281, 19.95432281, 32.10044861, 18.27315712, 13.79166222, 26.96515274, 32.77268982, 19.30791855, 26.16771889, 21.8395195, 12.22079182, 12.22079182, 21.8395195, 26.16771889, 19.30791855, 32.77268982, 26.96515274, 38.00551605, 44.8817749, 23.56672287, 27.14280701, 24.7010994, 26.94974136, 18.18262482, 41.78518295, 25.52963829, 12.35084438, 23.92583275, 29.39851189, 22.78663635, 17.16172409, 14.08822727, 23.29167747, 43.20004654, 7.741707802, 30.1517334, 34.65544128, 16.87238312, 20.67638779, 20.67638779, 16.87238312, 34.65544128, 30.1517334, 7.741707802, 43.20004654, 23.29167747, 14.08822727, 17.16172409, 22.78663635, 29.39851189, 23.92583275, 12.35084438, 25.52963829, 41.78518295, 18.18262482, 26.94974136, 24.7010994, 27.14280701, 23.56672287, 44.8817749, 38.00551605, 27.08095169, 15.25416183, 15.25416183, 27.08095169, 34.61734009, 26.6135807, 32.98656464, 9.606899261, 32.20135117, 34.74562454, 11.81522465, 10.8381052, 5.674238205, 17.69964981, 62.81964111, 62.81964111, 17.69964981, 5.674238205, 10.8381052, 11.81522465, 34.74562454, 32.20135117, 9.606899261, 32.98656464, 26.6135807, 34.61734009, 50.65113831, 52.74192429, 13.2403717, 50.32455826, 50.32455826, 13.2403717, 52.74192429, 50.65113831, 21.19114685, 9.176017761, 9.176017761, 21.19114685, 32.93720245, 30.89264488, 24.89771652, 20.27216721, 29.28691483, 15.03165436, 27.84318542, 34.68436432, 34.68436432, 27.84318542, 15.03165436, 29.28691483, 20.27216721, 24.89771652, 30.89264488, 32.93720245, 20.73518944, 48.29927826, 48.29927826, 20.73518944, 6.719681263, 17.64640999, 30.68091011, 15.46363926, 23.58017731, 20.0689621, 39.86466217, 27.83972359, 12.83865738, 16.58363533, 13.44682693, 16.30245018, 16.30245018, 13.44682693, 16.58363533, 12.83865738, 27.83972359, 39.86466217, 20.0689621, 23.58017731, 15.46363926, 30.68091011, 17.64640999, 6.719681263, 27.12191391, 2.961663246, 25.25554848, 17.62779236, 22.62646866, 36.46771622, 36.4128952, 11.50259686, 14.95877266, 21.88566017, 28.69185257, 36.83739471, 36.83739471, 28.69185257, 21.88566017, 14.95877266, 11.50259686, 36.4128952, 36.46771622, 22.62646866, 17.62779236, 25.25554848, 2.961663246, 27.12191391, 25.29393768, 17.32451248, 12.13477707, 25.57745552, 25.57745552, 12.13477707, 17.32451248, 25.29393768, 44.1743927, 45.1587944, 6.422393799, 0.8557809591, 11.29298401, 22.29253197, 10.27158737, 39.68115234, 15.76916122, 14.74081326, 14.74081326, 15.76916122, 39.68115234, 10.27158737, 22.29253197, 11.29298401, 0.8557809591, 6.422393799, 45.1587944, 44.1743927, 1.574051857, 30.36156845, 30.36156845, 1.574051857, 24.44804192, 52.11685562, 11.25370502, 53.2010498, 36.38677979, 28.00775719, 9.189598083, 13.18849754, 9.053028107, 23.64361572, 15.13273144, 18.57131004, 18.57131004, 15.13273144, 23.64361572, 9.053028107, 13.18849754, 9.189598083, 28.00775719, 36.38677979, 53.2010498, 11.25370502, 52.11685562, 24.44804192, 21.03116989, 18.33800316, 10.88628197, 10.88628197, 18.33800316, 21.03116989, 27.98948288, 5.415392876, 3.735046864, 20.55352974, 76.71188354, 13.2743988, 51.68177795, 25.157444, 5.967044353, 5.967044353, 25.157444, 51.68177795, 13.2743988, 76.71188354, 20.55352974, 3.735046864, 5.415392876, 27.98948288, 15.41703701, 25.33122826, 14.39577675, 21.77436638, 21.77436638, 14.39577675, 25.33122826, 15.41703701, 41.75048828, 12.49152184, 21.53453445, 23.02672005, 16.51511192, 16.62403297, 16.62403297, 16.51511192, 23.02672005, 21.53453445, 12.49152184, 41.75048828, 17.99378586, 30.66189003, 68.10175323, 16.0703907, 9.457947731, 35.68981171, 32.52541351, 26.23055077, 29.48114586, 39.52045441, 4.838356018, 15.79981232, 15.79981232, 4.838356018, 39.52045441, 29.48114586, 26.23055077, 32.52541351, 35.68981171, 9.457947731, 16.0703907, 68.10175323, 30.66189003, 17.99378586, 28.65183258, 28.65183258, 9.338945389, 9.338945389, 25.82771492, 28.39013672, 42.37106323, 9.863635063, 13.14507198, 40.67470932, 25.00154877, 10.50583935, 58.73340607, 32.45139313, 16.11537361, 14.03599453, 14.03599453, 16.11537361, 32.45139313, 58.73340607, 10.50583935, 25.00154877, 40.67470932, 13.14507198, 9.863635063, 42.37106323, 28.39013672, 25.82771492, 42.10860062, 63.0782547, 22.24442673, 20.55533981, 17.3488884, 23.1890316, 7.247262955, 32.478405, 12.28081322, 39.57626724, 33.63458633, 34.85544968, 19.60511589, 29.59932709, 29.59932709, 19.60511589, 34.85544968, 33.63458633, 39.57626724, 12.28081322, 32.478405, 7.247262955, 23.1890316, 17.3488884, 20.55533981, 22.24442673, 63.0782547, 42.10860062, 28.83471489, 22.21047592, 15.70080471, 29.11550522, 20.83918762, 2.932832956, 22.05906677, 14.52700615, 18.47239876, 21.71303177, 21.71303177, 18.47239876, 14.52700615, 22.05906677, 2.932832956, 20.83918762, 29.11550522, 15.70080471, 22.21047592, 28.83471489, 23.53705215, 11.36185551, 13.28255463, 13.28255463, 11.36185551, 23.53705215, 18.28559875, 18.28559875, 28.40058899, 7.612323761, 22.1194706, 23.1740818, 34.46437836, 29.62889481, 24.87004089, 17.90001106, 12.30208588, 12.30208588, 17.90001106, 24.87004089, 29.62889481, 34.46437836, 23.1740818, 22.1194706, 7.612323761, 28.40058899, 19.00841522, 19.00841522, 12.9498558, 12.9498558, 19.66072083, 5.124233723, 34.6622963, 32.34340286, 10.49704742, 14.63159561, 36.05694199, 17.36983871, 44.99233627, 24.41031647, 23.16533279, 19.12620926, 35.04272842, 35.04272842, 19.12620926, 23.16533279, 24.41031647, 44.99233627, 17.36983871, 36.05694199, 14.63159561, 10.49704742, 32.34340286, 34.6622963, 5.124233723, 19.66072083, 48.9961853, 10.08076382, 4.880791664, 11.80772018, 23.24902534, 14.52608204, 25.83365059, 10.32247543, 27.85143471, 22.59643936, 17.09150505, 17.09150505, 22.59643936, 27.85143471, 10.32247543, 25.83365059, 14.52608204, 23.24902534, 11.80772018, 4.880791664, 10.08076382, 48.9961853,  };
  return sfk_e_e_exected;
}

template<typename T>
typename  StructureFactorTests<T>::DataC StructureFactorTests<T>::getRhoKElec()
{    
  DataC rhok_e_expected = { (0.5924067497,-1.491295099), (3.584708452,-1.712368011), (0.3997975588,-3.005949497), (4.994470596,-5.147814274), (4.994470596,5.147814274), (0.3997975588,3.005949497), (3.584708452,1.712368011), (0.5924067497,1.491295099), (7.359516144,-5.6792202), (4.826219082,-5.896167755), (3.279859066,-8.152435303), (3.279859066,8.152435303), (4.826219082,5.896167755), (7.359516144,5.6792202), (2.076227188,-3.606255054), (3.45581913,-9.614717484), (-1.546550393,-3.149424314), (6.73450613,0.4296414852), (4.920219421,-1.791886091), (11.15685272,-1.166432381), (11.15685272,1.166432381), (4.920219421,1.791886091), (6.73450613,-0.4296414852), (-1.546550393,3.149424314), (3.45581913,9.614717484), (2.076227188,3.606255054), (0.6491305232,-5.774231911), (-3.71764946,-2.71548152), (0.2622945905,-8.464838982), (0.8365126848,-5.196321487), (2.131130219,-9.120963097), (7.443614483,0.1272249222), (-1.302274108,2.783902407), (-2.805317879,-4.100622654), (2.166297436,2.167853832), (8.253002167,1.212442398), (3.100903511,0.2963767648), (-3.347835541,-2.253051996), (-3.347835541,2.253051996), (3.100903511,-0.2963767648), (8.253002167,-1.212442398), (2.166297436,-2.167853832), (-2.805317879,4.100622654), (-1.302274108,-2.783902407), (7.443614483,-0.1272249222), (2.131130219,9.120963097), (0.8365126848,5.196321487), (0.2622945905,8.464838982), (-3.71764946,2.71548152), (0.6491305232,5.774231911), (2.391165257,-4.354510784), (1.974772215,-7.41988945), (0.4369556904,-1.177869081), (3.464332104,-12.54276276), (3.464332104,12.54276276), (0.4369556904,1.177869081), (1.974772215,7.41988945), (2.391165257,4.354510784), (3.547600985,-5.061825275), (-3.484699249,-5.007374287), (-2.511082172,1.347038388), (-2.511082172,-1.347038388), (-3.484699249,5.007374287), (3.547600985,5.061825275), (-4.758557796,-1.4227314), (-3.966060162,-0.7569956779), (-3.966060162,0.7569956779), (-4.758557796,1.4227314), (1.031636953,-5.657271862), (-8.92360878,-5.387914181), (4.195902824,-4.546901703), (4.829262257,3.230755568), (3.007032871,-5.985052109), (-2.540019989,-6.998126984), (2.830960274,1.483453035), (1.639224529,3.652080774), (-4.786507607,3.884080887), (2.714856625,1.799381852), (2.714856625,-1.799381852), (-4.786507607,-3.884080887), (1.639224529,-3.652080774), (2.830960274,-1.483453035), (-2.540019989,6.998126984), (3.007032871,5.985052109), (4.829262257,-3.230755568), (4.195902824,4.546901703), (-8.92360878,5.387914181), (1.031636953,5.657271862), (-2.995438814,-1.522596359), (-3.952926636,0.7274377346), (-2.676473856,-2.648072004), (2.056577682,-2.997202396), (6.533461571,-3.822700024), (-1.989242554,-3.323826075), (-2.446074486,0.1415935755), (-2.390799522,-1.153463006), (5.994254589,0.5641999245), (1.587408066,-5.109902859), (2.81265831,3.224537611), (0.4621456861,-0.6620330215), (0.4621456861,0.6620330215), (2.81265831,-3.224537611), (1.587408066,5.109902859), (5.994254589,-0.5641999245), (-2.390799522,1.153463006), (-2.446074486,-0.1415935755), (-1.989242554,3.323826075), (6.533461571,3.822700024), (2.056577682,2.997202396), (-2.676473856,2.648072004), (-3.952926636,-0.7274377346), (-2.995438814,1.522596359), (0.2932553291,2.283790827), (0.2932553291,-2.283790827), (-2.449538469,-3.938394547), (-4.169157028,-1.420828938), (-1.119577646,-7.335044384), (-3.06660223,-5.171131134), (4.478675365,-0.9375646114), (-2.30142498,-4.092213631), (0.4033448696,7.406522274), (-5.53929615,-4.483269691), (1.817272425,-4.938120842), (-1.283513784,-1.526912689), (-5.368692398,0.6403012276), (-5.368692398,-0.6403012276), (-1.283513784,1.526912689), (1.817272425,4.938120842), (-5.53929615,4.483269691), (0.4033448696,-7.406522274), (-2.30142498,4.092213631), (4.478675365,0.9375646114), (-3.06660223,5.171131134), (-1.119577646,7.335044384), (-4.169157028,1.420828938), (-2.449538469,3.938394547), (-2.349718094,-4.534374237), (-3.258060932,-6.563598633), (-5.269825935,5.625203133), (-1.056861639,-1.715589404), (2.943459511,1.621193409), (1.507925034,-1.25841105), (-8.943761826,-2.031452417), (-0.2633992434,-2.200559139), (-1.154777408,-2.864115238), (3.757408142,-0.1391367912), (5.542544365,-2.473004341), (1.33184135,-0.4289052486), (1.33184135,0.4289052486), (5.542544365,2.473004341), (3.757408142,0.1391367912), (-1.154777408,2.864115238), (-0.2633992434,2.200559139), (-8.943761826,2.031452417), (1.507925034,1.25841105), (2.943459511,-1.621193409), (-1.056861639,1.715589404), (-5.269825935,-5.625203133), (-3.258060932,6.563598633), (-2.349718094,4.534374237), (-5.006935596,-0.8101488948), (6.134077072,1.376995802), (-2.58267808,1.947652578), (-0.5679087043,-5.896474838), (-0.5679087043,5.896474838), (-2.58267808,-1.947652578), (6.134077072,-1.376995802), (-5.006935596,0.8101488948), (-4.242553711,-0.148026824), (3.14392066,-5.239214897), (-3.501530647,1.262228012), (4.789734364,1.410614848), (0.4787006378,3.037798405), (2.685522079,2.979806185), (2.685522079,-2.979806185), (0.4787006378,-3.037798405), (4.789734364,-1.410614848), (-3.501530647,-1.262228012), (3.14392066,5.239214897), (-4.242553711,0.148026824), (-8.816467285,2.135006428), (-3.966232538,-10.40109634), (-3.992070198,-2.509442091), (-4.318099976,1.254590392), (7.517472267,-0.883942306), (1.476297617,0.3583492041), (-1.905166984,-1.170188785), (2.860048771,-1.935360193), (-6.622910976,1.248441696), (-3.721976042,-0.6532094479), (5.397536755,-0.5902895927), (3.959159136,2.64208293), (0.2132015228,2.653470993), (-0.5940680504,1.017179847), (1.364158273,-2.555692434), (4.447151661,3.147212744), (-2.467634439,-7.81071806), (1.248704433,3.042328119), (-1.876766443,-1.636115551), (4.225340843,8.04101181), (1.958802819,-2.829083681), (-0.5199436545,-3.344742537), (-0.5199436545,3.344742537), (1.958802819,2.829083681), (4.225340843,-8.04101181), (-1.876766443,1.636115551), (1.248704433,-3.042328119), (-2.467634439,7.81071806), (4.447151661,-3.147212744), (1.364158273,2.555692434), (-0.5940680504,-1.017179847), (0.2132015228,-2.653470993), (3.959159136,-2.64208293), (5.397536755,0.5902895927), (-3.721976042,0.6532094479), (-6.622910976,-1.248441696), (2.860048771,1.935360193), (-1.905166984,1.170188785), (1.476297617,-0.3583492041), (7.517472267,0.883942306), (-4.318099976,-1.254590392), (-3.992070198,2.509442091), (-3.966232538,10.40109634), (-8.816467285,-2.135006428), (-7.380677223,-2.085382462), (-1.813711286,-3.303716898), (-1.813711286,3.303716898), (-7.380677223,2.085382462), (-3.442320824,-3.390959024), (-5.427708149,0.8670220971), (-1.383381367,-2.30133605), (-1.27065289,0.806579113), (-0.1855710745,-8.051383018), (1.988223791,-8.346243858), (1.00059104,2.997005463), (-3.695013523,1.744617939), (1.796917796,1.001032114), (-3.90969038,-0.09522914886), (-1.423160553,-2.237792015), (-1.423160553,2.237792015), (-3.90969038,0.09522914886), (1.796917796,-1.001032114), (-3.695013523,-1.744617939), (1.00059104,-2.997005463), (1.988223791,8.346243858), (-0.1855710745,8.051383018), (-1.27065289,-0.806579113), (-1.383381367,2.30133605), (-5.427708149,-0.8670220971), (-3.442320824,3.390959024), (-2.299573898,6.924650192), (-4.531122208,-2.911784649), (2.221989632,-1.75119853), (2.176891804,10.40933418), (2.176891804,-10.40933418), (2.221989632,1.75119853), (-4.531122208,2.911784649), (-2.299573898,-6.924650192), (-0.7874586582,-4.425065041), (1.992164373,3.124239445), (1.992164373,-3.124239445), (-0.7874586582,4.425065041), (-1.798467398,1.35413909), (6.019507408,-0.3360600471), (-7.235887051,-1.991593838), (-0.07142817974,3.503325939), (-1.178472519,3.673949957), (-3.244167328,-1.830079556), (-4.368251801,-3.369636059), (-0.3029971123,-3.641766548), (-0.3029971123,3.641766548), (-4.368251801,3.369636059), (-3.244167328,1.830079556), (-1.178472519,-3.673949957), (-0.07142817974,-3.503325939), (-7.235887051,1.991593838), (6.019507408,0.3360600471), (-1.798467398,-1.35413909), (-2.809275627,-1.857904792), (-4.59763813,-5.219004631), (-4.59763813,5.219004631), (-2.809275627,1.857904792), (-0.768925488,2.00369072), (1.213478804,5.054683208), (3.966674089,-4.715129852), (3.606037378,0.1961832047), (-5.423397064,3.434875488), (2.249715328,-0.3219296932), (3.880141735,6.799582481), (-0.465303421,0.6773622036), (-4.861494064,3.035137892), (-2.970816612,1.346918821), (1.45413506,3.225545168), (-2.470086098,-1.489482999), (-2.470086098,1.489482999), (1.45413506,-3.225545168), (-2.970816612,-1.346918821), (-4.861494064,-3.035137892), (-0.465303421,-0.6773622036), (3.880141735,-6.799582481), (2.249715328,0.3219296932), (-5.423397064,-3.434875488), (3.606037378,-0.1961832047), (3.966674089,4.715129852), (1.213478804,-5.054683208), (-0.768925488,-2.00369072), (-2.220051289,1.512348294), (-1.235956073,0.7785832882), (-5.847000122,-0.0147203207), (-4.717791557,1.951827765), (-3.773251534,-4.990011215), (2.884654999,3.398807526), (5.672742367,0.7873437405), (4.248654366,2.139424801), (-4.828884125,0.4608916044), (-4.072755337,1.278635025), (0.2896728516,0.2327990532), (3.294314384,-1.094229102), (3.294314384,1.094229102), (0.2896728516,-0.2327990532), (-4.072755337,-1.278635025), (-4.828884125,-0.4608916044), (4.248654366,-2.139424801), (5.672742367,-0.7873437405), (2.884654999,-3.398807526), (-3.773251534,4.990011215), (-4.717791557,-1.951827765), (-5.847000122,0.0147203207), (-1.235956073,-0.7785832882), (-2.220051289,-1.512348294), (0.9226903319,4.267571449), (-1.437251925,-3.580348253), (0.03603422642,-1.275114536), (-5.739364624,-0.1097413301), (-5.739364624,0.1097413301), (0.03603422642,1.275114536), (-1.437251925,3.580348253), (0.9226903319,-4.267571449), (-5.211256981,7.146552086), (4.157069683,6.030432701), (-4.010327339,-1.533936262), (-0.6967151761,-0.0959803462), (2.036157131,3.429550409), (-2.729854584,3.902244806), (3.364386082,1.030713558), (-1.500010014,-4.306185722), (-2.978727341,4.799777031), (-4.733328819,-0.2710825205), (-4.733328819,0.2710825205), (-2.978727341,-4.799777031), (-1.500010014,4.306185722), (3.364386082,-1.030713558), (-2.729854584,-3.902244806), (2.036157131,-3.429550409), (-0.6967151761,0.0959803462), (-4.010327339,1.533936262), (4.157069683,-6.030432701), (-5.211256981,-7.146552086), (-0.2306147218,-0.5819837451), (-6.305120945,-1.457084179), (-6.305120945,1.457084179), (-0.2306147218,0.5819837451), (-5.17535162,-0.2336061001), (-0.2841696143,-10.6944809), (-2.390393257,-0.7063763142), (1.107917547,-1.777672529), (5.721277237,-5.00039959), (6.430810928,0.4185490012), (-1.039620161,4.589290142), (4.601204872,0.6167341471), (2.573006153,2.296423435), (6.217131615,3.523381472), (3.895627022,-0.699914217), (2.557150126,-6.427192211), (2.557150126,6.427192211), (3.895627022,0.699914217), (6.217131615,-3.523381472), (2.573006153,-2.296423435), (4.601204872,-0.6167341471), (-1.039620161,-4.589290142), (6.430810928,-0.4185490012), (5.721277237,5.00039959), (1.107917547,1.777672529), (-2.390393257,0.7063763142), (-0.2841696143,10.6944809), (-5.17535162,0.2336061001), (-2.54470849,-4.587264538), (-1.740908504,-3.925166845), (-0.158428967,2.498699665), (-0.158428967,-2.498699665), (-1.740908504,3.925166845), (-2.54470849,4.587264538), (-6.729282379,0.1392500401), (-1.508695841,-0.7561137676), (-1.462480307,0.6218969226), (-0.321264863,-0.7247383595), (8.637511253,0.7257275581), (-0.9631168246,1.153114796), (-3.088907242,8.718103409), (4.214176178,-1.945542574), (-3.311136723,0.9504836202), (-3.311136723,-0.9504836202), (4.214176178,1.945542574), (-3.088907242,-8.718103409), (-0.9631168246,-1.153114796), (8.637511253,-0.7257275581), (-0.321264863,0.7247383595), (-1.462480307,-0.6218969226), (-1.508695841,0.7561137676), (-6.729282379,-0.1392500401), (0.200414896,-0.8899208307), (-3.520216942,-2.698538303), (-1.002582073,0.08162379265), (-2.358664274,-2.249558926), (-2.358664274,2.249558926), (-1.002582073,-0.08162379265), (-3.520216942,2.698538303), (0.200414896,0.8899208307), (-3.408019781,8.709181786), (2.158164024,-0.1445958614), (2.64282155,4.411319733), (-0.4583158493,2.501485348), (-0.424772501,0.7248215675), (-3.711930752,-0.3703078032), (-3.711930752,0.3703078032), (-0.424772501,-0.7248215675), (-0.4583158493,-2.501485348), (2.64282155,-4.411319733), (2.158164024,0.1445958614), (-3.408019781,-8.709181786), (-1.891610861,6.444361687), (-0.02526116371,-2.683085442), (7.09794426,-0.2332104445), (-2.015702248,3.50109911), (3.243085146,-1.314267516), (2.156584501,0.4628716707), (3.525612593,5.440950394), (1.228835583,-0.3453999162), (-0.478734374,8.110942841), (-4.417645931,3.435180187), (-0.3485159278,1.372372866), (-0.2073709965,-0.07035624981), (-0.2073709965,0.07035624981), (-0.3485159278,-1.372372866), (-4.417645931,-3.435180187), (-0.478734374,-8.110942841), (1.228835583,0.3453999162), (3.525612593,-5.440950394), (2.156584501,-0.4628716707), (3.243085146,1.314267516), (-2.015702248,-3.50109911), (7.09794426,0.2332104445), (-0.02526116371,2.683085442), (-1.891610861,-6.444361687), (3.285906792,-6.027932167), (3.285906792,6.027932167), (-1.367059708,-2.100066662), (-1.367059708,2.100066662), (3.421066761,5.951356888), (0.9868799448,-1.311420441), (-1.627541304,5.462136269), (-3.990864277,1.102679849), (1.300173998,0.7606943846), (8.343988419,-0.8481897116), (-1.63301301,1.46787715), (-1.652385354,2.130233288), (6.521931171,4.971187592), (-1.634993196,-6.445318222), (-1.000563025,6.159612179), (-4.145616531,-0.2669619322), (-4.145616531,0.2669619322), (-1.000563025,-6.159612179), (-1.634993196,6.445318222), (6.521931171,-4.971187592), (-1.652385354,-2.130233288), (-1.63301301,-1.46787715), (8.343988419,0.8481897116), (1.300173998,-0.7606943846), (-3.990864277,-1.102679849), (-1.627541304,-5.462136269), (0.9868799448,1.311420441), (3.421066761,-5.951356888), (-7.250906944,4.418672562), (-4.982307434,-7.65216732), (1.850622296,-2.512521744), (-1.400040746,1.869890451), (5.249089718,-2.353768826), (-0.2356463671,2.200823784), (1.352718472,-0.7274159789), (4.983772278,6.636553764), (-2.008724928,3.623922348), (-4.296545029,-0.5656754971), (2.036823273,1.873584747), (6.78609848,-5.275559425), (1.594316721,-0.8120986223), (3.135821342,2.274452925), (3.135821342,-2.274452925), (1.594316721,0.8120986223), (6.78609848,5.275559425), (2.036823273,-1.873584747), (-4.296545029,0.5656754971), (-2.008724928,-3.623922348), (4.983772278,-6.636553764), (1.352718472,0.7274159789), (-0.2356463671,-2.200823784), (5.249089718,2.353768826), (-1.400040746,-1.869890451), (1.850622296,2.512521744), (-4.982307434,7.65216732), (-7.250906944,-4.418672562), (-5.363657951,1.124087811), (-1.567838907,3.671515465), (2.337051153,-5.62945652), (6.950581551,-1.243847132), (2.125556469,3.765841961), (0.9406456947,1.451031923), (-2.119028568,-1.426778078), (4.993509293,-2.385100842), (-1.50265789,-2.871356726), (6.083207607,1.23132658), (6.083207607,-1.23132658), (-1.50265789,2.871356726), (4.993509293,2.385100842), (-2.119028568,1.426778078), (0.9406456947,-1.451031923), (2.125556469,-3.765841961), (6.950581551,1.243847132), (2.337051153,5.62945652), (-1.567838907,-3.671515465), (-5.363657951,-1.124087811), (-2.053162098,-1.063462973), (-1.678141475,3.762696266), (0.0007864236832,1.058095455), (0.0007864236832,-1.058095455), (-1.678141475,-3.762696266), (-2.053162098,1.063462973), (2.29822731,1.357947469), (2.29822731,-1.357947469), (2.836388111,5.724801064), (-0.5488714576,-1.98086977), (1.778634548,2.7628932), (-3.494198561,-1.180356979), (3.874499798,-1.15323329), (5.613768578,-6.254772186), (-2.863878012,3.081430912), (0.6554439664,4.137325287), (4.995419502,-0.2541038394), (4.995419502,0.2541038394), (0.6554439664,-4.137325287), (-2.863878012,-3.081430912), (5.613768578,6.254772186), (3.874499798,1.15323329), (-3.494198561,1.180356979), (1.778634548,-2.7628932), (-0.5488714576,1.98086977), (2.836388111,-5.724801064), (4.070603371,-4.396873474), (4.070603371,4.396873474), (2.980705261,1.138022184), (2.980705261,-1.138022184), (3.674338818,1.130653381), (0.03487324715,0.733140707), (0.9849895239,-4.404793262), (0.1247190237,3.179280758), (0.0411696434,-1.996884108), (3.971215248,1.024628162), (2.22546649,2.114651203), (0.8446412086,-1.650652885), (-11.17575455,1.761610866), (-2.91852355,5.771692276), (-2.780082464,-4.580620766), (-1.15428555,3.912901878), (-1.566892385,5.624961853), (-1.566892385,-5.624961853), (-1.15428555,-3.912901878), (-2.780082464,4.580620766), (-2.91852355,-5.771692276), (-11.17575455,-1.761610866), (0.8446412086,1.650652885), (2.22546649,-2.114651203), (3.971215248,-1.024628162), (0.0411696434,1.996884108), (0.1247190237,-3.179280758), (0.9849895239,4.404793262), (0.03487324715,-0.733140707), (3.674338818,-1.130653381), (-8.700888634,2.00682354), (-0.03683960438,-4.234910011), (-1.239307284,1.285633802), (3.913101912,1.040015101), (3.92149353,-0.4837493896), (-1.704045177,-1.159303665), (2.514077187,-4.360420227), (0.7877758145,2.334750891), (-2.096787453,0.8956620693), (-1.136339307,1.45267415), (0.2019445896,-1.723826885), (0.2019445896,1.723826885), (-1.136339307,-1.45267415), (-2.096787453,-0.8956620693), (0.7877758145,-2.334750891), (2.514077187,4.360420227), (-1.704045177,1.159303665), (3.92149353,0.4837493896), (3.913101912,-1.040015101), (-1.239307284,-1.285633802), (-0.03683960438,4.234910011), (-8.700888634,-2.00682354),  };
}

} // namespace qmcplusplus
